fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
)
plot_object + ggplot2::facet_wrap(facets = vars(facet), labeller = as.character)
plot_object + ggplot2::facet_wrap(facets = vars(facet), labeller = labeller(type = label_parsed))
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = count,
x = facet,
fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
) +
#ggplot2::facet_wrap(facets = vars(facet)) +
ggplot2::labs(
title = title,
subtitle = subtitle,
fill = legend_title,
x = axis_x_title,
y = axis_y_title
) +
ggplot2::theme(legend.position = "none");
plot_object
ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
)
plot_barchart_gradients = function(
title = NULL,
subtitle = NULL,
axis_x_title = NULL,
axis_y_title = NULL,
plot_data, # Pre-summarized data
legend_title, = "Legend"
facet_labeller = NULL
){
# Returns a GGPlot2 barchart
# with gradient colors
# and bars ordered by factor levels.
display_facets = FALSE;
if(is.element("facet", colnames(plot_data))){
display_facets = TRUE;
} else {
plot_data$facet = NULL;
}
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
) +
ggplot2::facet_wrap(facets = vars(facet), labeller = facet_labeller) +
ggplot2::labs(
title = title,
subtitle = subtitle,
fill = legend_title,
x = axis_x_title,
y = axis_y_title
) +
ggplot2::theme(legend.position = "none");
#if(display_facets){
#  plot_object = plot_object + ggplot2::facet_wrap(~plot_data$facet);
#}
return(plot_object);
}
facet_titles <- list(
"a" = "Used benchmarking with peer organizations",
"b" = "Would benefit from standardized indicators",
"c" = "Would benefit from benchmarking with peer organizations"
);
facet_labeller <- function(variable,value){
return(facet_titles[value]);
}
plot_object
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
)
plot_object
plot_object + ggplot2::facet_wrap(facets = vars(facet), labeller = facet_labeller)
?ggplot2::labellers
?ggplot2::labeller
q38_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q38,
ordering_option = "level");
q38_plot_data$facet = "a";
q39_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q39,
ordering_option = "level");
q39_plot_data$facet = "b";
q40_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q40,
ordering_option = "level");
q40_plot_data$facet = "c";
facet_titles <- list(
"a" = "Used benchmarking with peer organizations",
"b" = "Would benefit from standardized indicators",
"c" = "Would benefit from benchmarking with peer organizations"
);
plot_object
facet_labeller = ggplot2::labeller(
facet = facet_titles
);
plot_object
plot_object + facet_wrap(facet, labeller = facet_labeller)
plot_object + facet_wrap(~facet, labeller = facet_labeller)
plot_object$data
q38_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q38,
ordering_option = "level");
q38_plot_data$facet = "a";
q39_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q39,
ordering_option = "level");
q39_plot_data$facet = "b";
q40_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q40,
ordering_option = "level");
q40_plot_data$facet = "c";
facet_titles <- list(
"a" = "Used benchmarking with peer organizations",
"b" = "Would benefit from standardized indicators",
"c" = "Would benefit from benchmarking with peer organizations"
);
facet_labeller = ggplot2::labeller(
facet = facet_titles
);
plot_object + facet_wrap(~facet, labeller = facet_labeller)
plot_object + facet_wrap(facet, labeller = facet_labeller)
plot_object + facet_wrap(plot_data$facet, labeller = facet_labeller)
plot_object + facet_wrap(vars(facet), labeller = facet_labeller)
plot_object + facet_wrap(vars(facet))
plot_object$data
plot_data = rbind(
q38_plot_data,
q39_plot_data,
q40_plot_data
);
plot_object + facet_wrap(vars(facet))
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
)
plot_object
plot_object + facet_wrap(vars(facet))
plot_object$facet
plot_object$data
plot_data
plot_object$data
plot_object
plot_object + facet_wrap(facets = vars(facet))
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category,
facet = facet)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
)
plot_object + facet_wrap(facets = vars(facet))
plot_object + facet_wrap(vars(facet))
q38_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q38,
ordering_option = "level");
q38_plot_data$facet_name = "a";
q39_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q39,
ordering_option = "level");
q39_plot_data$facet_name = "b";
q40_plot_data = prepare_data_barchart_with_single_column_coercion(
plot_data = iamperf2020_survey$Q40,
ordering_option = "level");
q40_plot_data$facet_name = "c";
facet_titles <- list(
"a" = "Used benchmarking with peer organizations",
"b" = "Would benefit from standardized indicators",
"c" = "Would benefit from benchmarking with peer organizations"
);
facet_labeller = ggplot2::labeller(
facet = facet_titles
);
plot_data = rbind(
q38_plot_data,
q39_plot_data,
q40_plot_data
);
plot_data$facet_name = factor(plot_data$facet_name, ordered = FALSE);
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category,
facet = facet)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
)
plot_object
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category,
facet_name = facet_name)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
) +
#ggplot2::facet_wrap(facets = vars(facet), labeller = facet_labeller) +
ggplot2::labs(
title = title,
subtitle = subtitle,
fill = legend_title,
x = axis_x_title,
y = axis_y_title
) +
ggplot2::theme(legend.position = "none");
plot_object
plot_object + facet_wrap(vars(facet_name))
plot_object$data
plot_object$data$facet_name
plot_object + facet_wrap(vars(facet_name))
plot_object + facet_wrap(facet_name)
plot_object + facet_wrap(~facet_name)
plot_object + facet_wrap("facet_name")
plot_barchart_gradients = function(
title = NULL,
subtitle = NULL,
axis_x_title = NULL,
axis_y_title = NULL,
plot_data, # Pre-summarized data
legend_title = "Legend"
){
# Returns a GGPlot2 barchart
# with gradient colors
# and bars ordered by factor levels.
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category,
facet_name = facet_name)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
) +
ggplot2::labs(
title = title,
subtitle = subtitle,
fill = legend_title,
x = axis_x_title,
y = axis_y_title
) +
ggplot2::theme(legend.position = "none");
return(plot_object);
}
plot_q38 = plot_q38_barchart();
plot_q39 = plot_q39_barchart();
plot_q40 = plot_q40_barchart();
ggpubr::ggarrange(plot_q38, plot_q39, plot_q40, ncol = 1, nrow = 3);
plot_q38_barchart();
plot_barchart_gradients = function(
title = NULL,
subtitle = NULL,
axis_x_title = NULL,
axis_y_title = NULL,
plot_data, # Pre-summarized data
legend_title = "Legend"
){
# Returns a GGPlot2 barchart
# with gradient colors
# and bars ordered by factor levels.
plot_object = ggplot2::ggplot(
data = plot_data,
ggplot2::aes(
y = category,
x = count,
fill = category,
facet_name = facet_name)
) +
scale_fill_brewer(palette = "YlGnBu") +
ggplot2::geom_bar(
stat = "identity",
position = ggplot2::position_dodge(width = .75),
colour = "black"
) +
ggplot2::geom_text(
ggplot2::aes(label = label),
hjust = -0.5,
size = 3,
position = position_dodge(width = 1),
inherit.aes = TRUE
) +
ggplot2::xlim(
0, round(max(plot_data$count) * 1.1,0)
) +
ggplot2::theme(
panel.spacing = ggplot2::unit(c(.1,.1,.1,.1), "cm"),
plot.margin = ggplot2::unit(c(.1,.1,.1,.1), "cm")
) +
ggplot2::labs(
title = title,
subtitle = subtitle,
fill = legend_title,
x = axis_x_title,
y = axis_y_title
) +
ggplot2::theme(legend.position = "none");
return(plot_object);
}
plot_q38 = plot_q38_barchart();
plot_q39 = plot_q39_barchart();
plot_q40 = plot_q40_barchart();
ggpubr::ggarrange(plot_q38, plot_q39, plot_q40, ncol = 1, nrow = 3);
